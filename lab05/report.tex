\documentclass[a4paper,12pt]{article}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[polish]{babel}
\usepackage{color}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{hyperref}
\usepackage{float}
\usepackage{listings}
\usepackage[backend=biber]{biblatex}

\addbibresource{bibliografia.bib}

\lstset{
  basicstyle=\ttfamily,
  columns=flexible,
  keepspaces=true,
  showstringspaces=false,
  escapeinside={(*@}{@*)},
  literate={ą}{{\k{a}}}1
           {ć}{{\'{c}}}1
           {ę}{{\k{e}}}1
           {ł}{{\l{}}}1
           {ń}{{\'{n}}}1
           {ó}{{\'{o}}}1
           {ś}{{\'{s}}}1
           {ź}{{\'{z}}}1
           {ż}{{\.{z}}}1
           {Ą}{{\k{A}}}1
           {Ć}{{\'{C}}}1
           {Ę}{{\k{E}}}1
           {Ł}{{\L{}}}1
           {Ń}{{\'{N}}}1
           {Ó}{{\'{O}}}1
           {Ś}{{\'{S}}}1
           {Ź}{{\'{Z}}}1
           {Ż}{{\.{Z}}}1
           {"}{{\textquotedbl}}1
           {'}{{\textquotesingle}}1
           {`}{{\textasciigrave}}1
           {~}{{\textasciitilde}}1
           {^}{{\textasciicircum}}1
           {_}{{\textunderscore}}1
           {|}{{\textbar}}1
           {\{}{{\textbraceleft}}1
           {\}}{{\textbraceright}}1
           {[}{{[}}1
           {]}{{]}}1
}

\title{5. sprawozdanie z laboratorium Hurtownie Danych}
\author{Mikołaj Kubś, 272662}
\date{\today}

\begin{document}

\maketitle

\section{Zadanie 1 - Przygotowanie powtarzalności procesu ETL}

 {\small
  \begin{lstlisting}[
  language=SQL,
  showspaces=false,
  basicstyle=\ttfamily,
  numbers=left,
  numberstyle=\tiny,
  commentstyle=\color{green},
  tabsize=2
]
IF EXISTS (
    SELECT
        *
    FROM
        INFORMATION_SCHEMA.TABLE_CONSTRAINTS
    WHERE
        CONSTRAINT_SCHEMA = 'Kubs'
        AND CONSTRAINT_NAME = 'FK_FACT_SALES_DIM_CUSTOMER'
        AND TABLE_NAME = 'FACT_SALES'
)
ALTER TABLE
    Kubs.FACT_SALES DROP CONSTRAINT FK_FACT_SALES_DIM_CUSTOMER;

IF EXISTS (
    SELECT
        *
    FROM
        INFORMATION_SCHEMA.TABLE_CONSTRAINTS
    WHERE
        CONSTRAINT_SCHEMA = 'Kubs'
        AND CONSTRAINT_NAME = 'FK_FACT_SALES_DIM_PRODUCT'
        AND TABLE_NAME = 'FACT_SALES'
)
ALTER TABLE
    Kubs.FACT_SALES DROP CONSTRAINT FK_FACT_SALES_DIM_PRODUCT;

IF EXISTS (
    SELECT
        *
    FROM
        INFORMATION_SCHEMA.TABLE_CONSTRAINTS
    WHERE
        CONSTRAINT_SCHEMA = 'Kubs'
        AND CONSTRAINT_NAME = 'FK_FACT_SALES_DIM_SALESPERSON'
        AND TABLE_NAME = 'FACT_SALES'
)
ALTER TABLE
    Kubs.FACT_SALES DROP CONSTRAINT FK_FACT_SALES_DIM_SALESPERSON;

DROP TABLE IF EXISTS Kubs.FACT_SALES;

DROP TABLE IF EXISTS Kubs.DIM_CUSTOMER;

DROP TABLE IF EXISTS Kubs.DIM_PRODUCT;

DROP TABLE IF EXISTS Kubs.DIM_SALESPERSON;

DROP TABLE IF EXISTS Kubs.DIM_TIME;

DROP TABLE IF EXISTS Kubs.Helper_Months;

DROP TABLE IF EXISTS Kubs.Helper_Weekdays;
\end{lstlisting}}

\section{Zadanie 2 - Wymiar czasowy}

\section{Zadanie 3 - Elementarne czyszczenie danych}

\section{Zadanie 4 - Proces Extact - Transform - Load}

\section{Zadanie 5 - ETL (prawie) bez SQLa}

\section{Wnioski}

\printbibliography

\end{document}